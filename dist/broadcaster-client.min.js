!function(){function a(a,b){var c=this;b||(b={}),c.mode=f;for(var d in b)c[d]=b[d];if(!a)throw new Error("Missing URL");c.auth||(c.auth={});var e=document.createElement("a");e.href=a,c._secure="https"===e.protocol,c._host=e.host,c._path=e.pathname}function b(a){this.client=a}function c(a){this.client=a}var d="_transport",e="__type",f="auto",g="websocket",h="longpoll";a.prototype.connect=function(a){function e(b){return b?a(b):void a()}var i=this,j=i.mode;j===f||j===g?(i[d]=new b(i),i[d].connect(i.auth,function(a){a&&j===f?(i[d]=new c(i),i[d].connect(i.auth,e)):e(a)})):j===h?(i[d]=new c(i),i[d].connect(i.auth,e)):a("Unknown client mode")},a.prototype.url=function(a){var b="ws";return a===h&&(b="http"),this._secure&&(b+="s"),b+"://"+this._host+this._path},b.prototype.connect=function(a,b){var c=this,d=new WebSocket(c.client.url(g));d.onmessage=function(a){var c=JSON.parse(a.data);"authFailed"===c[e]?b(new Error(c.reason)):b()},d.onopen=function(){a[e]="auth",d.send(JSON.stringify(a))},c.conn=d},c.prototype.connect=function(a,b){b()},this.BroadcasterClient=a}();